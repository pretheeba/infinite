--4.Create table Employee with empno, ename, sal, doj columns and perform the following operations in a single transaction
 --a.First insert 3 rows 
 --b.Update the second row sal with 15% increment  
 --c.Delete first row.
 --After completing above all actions how to recall the deleted row without losing increment of second row.

Create Table Employee (
            EmpNo int PRIMARY KEY,
            EName varchar(50),
            Sal float,
            DOJ DATE )
			
			
     Begin transaction
	 --a. First insert 3 rows
         Insert into Employee Values (101, 'john', 30000, '2022-04-09'), (102, 'jeny', 50000, '2021-06-06'),
       (103, 'jones', 20000, '2020-08-03')

        -- b. Update the second row sal with 15% increment
         Update Employee Set Sal = Sal * 1.15
         where Empno = 102
        
         save tran t1

        -- c. Delete first row
         Delete From Employee 
         where empno = 101

	
         
        --Recalling the deleted row without loosing increment of second row
         rollback tran t1

         Commit

	 Select * from  employee


 
--5. Create a user defined function calculate Bonus for all employees of a  given job using 	following conditions
--a. For Deptno 10 employees 15% of sal as bonus.
--b. For Deptno 20 employees  20% of sal as bonus
--c. For Others employees 5%of sal as bonus
create or alter function Calculate_Bonus(@Salary float, @DeptNo int)
returns float
as
begin
declare @Bonus float
if (@DeptNo = 10)
set @Bonus = @Salary * 0.15
else if (@DeptNo = 20)
set @Bonus = @Salary * 0.20
else
set @Bonus = @Salary * 0.05
return @Bonus
end
--calling the function
select empno, ename, sal, hiredate, dbo.Calculate_Bonus(sal, deptno) as Bonus
from EMP
where deptno = 10

 